# dont touch $1 or $BASH_REMATCH or $REPLY
if [ -d .git ]
then
  # config
  read -d, ee <.git/config
  ff='filemode = true'
  if [[ $ee =~ $ff ]]
  then
    git config core.filemode false
  fi
  # HEAD
  read ee <.git/HEAD
  if [[ $ee < g ]]
  then
    ee=${ee::7}
  else
    ee=${ee/*\/}
  fi
  ee="($ee)"
fi

PS1="\e];${SHELL/*\/}\a
\e[32m\u@\h \e[33m\w $ee\e[m
$ "

unset ee ff
